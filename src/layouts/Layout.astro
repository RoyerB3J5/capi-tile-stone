---
// Imports optimizados - solo lo esencial al inicio
import '../styles/global.css';
import 'aos/dist/aos.css';

import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';

type Translations = typeof import('../i18n/en').default;

export interface Props {
  lang: string;
  t?: Translations;
}

const { lang, t } = Astro.props;
---
<!doctype html>
<html lang={lang} class='overflow-x-hidden'>
	<head>
		<meta charset="UTF-8" />
		<meta name='viewport' content='width=device-width, initial-scale=1.0' />
		
		<!-- Crítico: CSS inline para evitar FOUC -->
		<style is:inline>
      body {
        visibility: hidden;
        font-family: 'Red Hat Text', Arial, sans-serif;
      }
      body.visible {
        visibility: visible;
      }
    </style>
	
		<!-- Load Google Fonts de forma ultra-optimizada -->
		<link rel="preload" href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:wght@300..700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
		<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:wght@300..700&display=swap"></noscript>
				
		<meta name="generator" content={Astro.generator} />
		<title>Capi Tile & Stone</title>
	</head>
	<body class='font-family antialiased overflow-x-hidden bg-[#FAFAFA] flex flex-col justify-center items-center'>
		<Header content={t?.header} />
		<main class='flex flex-col w-full items-center'>
			<slot />
		</main>
		<Footer content={t?.footer}/>
		
		<script>
			import AOS from 'aos';
			
			// Función simplificada para inicializar AOS
			function initAOS() {
				try {
					AOS.init({
						duration: 1000,
						once: true,
						offset: 100,
						delay: 100,
						disable: false // Habilitar en todos los dispositivos
					});
					console.log('AOS inicializado correctamente');
				} catch (error) {
					console.error('Error al inicializar AOS:', error);
				}
			}

			function showContent() {
				document.body.classList.add('visible');
			}

			// Inicialización optimizada pero funcional
			function initializeApp() {
				// Mostrar contenido inmediatamente
				showContent();
				
				// Inicializar AOS con un pequeño delay
				setTimeout(() => {
					initAOS();
				}, 100);
			}

			// Inicialización según el estado del documento
			if (document.readyState === 'loading') {
				document.addEventListener('DOMContentLoaded', initializeApp);
			} else {
				initializeApp();
			}
			
			// Fallback garantizado para mostrar contenido
			setTimeout(showContent, 500);
		</script>
	</body>
</html>